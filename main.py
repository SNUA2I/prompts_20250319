import streamlit as st
import re
from collections import defaultdict

# 페이지 설정
st.set_page_config(
    page_title="프롬프트 엔지니어링 실습",
    page_icon="📚",
    layout="wide"
)

# 비밀번호 설정
PASSWORD = "1111"

# 데이터 준비 함수
def prepare_data():
    """프롬프트 데이터를 파싱하여 카테고리별로 정리합니다."""
    # 프롬프트 데이터
    data = """
<<대규모 언어 모델의 특징>>
--- 언어 모델과 학습 패턴 (1) --------------------------------------------------------------
다음 이야기를 완성하세요.
옛날 옛적, 착한 콩쥐와

--- 언어 모델과 학습 패턴 (2) --------------------------------------------------------------
다음 이야기를 완성하세요.
콩쥐라는 여자 아이가 자전거 타기를 좋아합니다.

<<프롬프트 기법>>
--- 일반 프롬프트 작성 / zero-shot (1) ----------------------------------------------------
영화 리뷰를 '긍정', '중립' 또는 '부정'으로 분류합니다.
리뷰: 이 영화는 인간과 기술의 관계를 탐구하며, 시청자로 하여금 깊은 통찰을 얻게 만든다. 특히 연출과 연기가 훌륭해 다시 보고 싶은 영화 중 하나다.
Sentiment:

--- 일반 프롬프트 작성 / zero-shot (2) ----------------------------------------------------
영화 리뷰를 '긍정', '중립' 또는 '부정'으로 분류합니다.
리뷰: 캐릭터와 플롯의 조화가 부족해 집중하기 어려웠다. 스토리가 더 정교했다면 훌륭했을 것이다.
Sentiment:

--- One-shot & Few-shot -----------
고객의 피자 주문을 유효한 JSON으로 변환한다.

예:
치즈, 토마토 소스, 페퍼로니가 들어간 작은 피자를 원합니다.
JSON 응답:
{"크기": "스몰", "유형": "기본", "재료": [["치즈", "토마토 소스", "페퍼로니"]]}

예:
토마토 소스, 바질, 모짜렐라를 곁들인 라지 피자를 주문할 수 있을까요?
JSON 응답:
{"크기": "라지", "유형": "기본","재료": [["토마토 소스", "바질", "모짜렐라"]]}

절반은 치즈와 모짜렐라를 그리고 나머지 절반은 토마토 소스, 햄, 파인애플을 곁들인 라지 피자를 주세요.
JSON 응답:

--- 페르소나: Role Prompting (1) ------------------------------------------------------
당신은 프로그래밍 튜터입니다. 사용자가 배우고 싶은 프로그래밍 언어나 해결하고 싶은 문제를 알려주면, 단계별로 설명해주세요.
예시 요청: "나는 파이썬으로 간단한 계산기를 만들고 싶습니다."
단계별 안내:

--- 페르소나: Role Prompting (2) ------------------------------------------------------
1차 방정식을 나에게 설명해주세요. 내가 칭기즈 칸이라고 가정하세요.

--- 페르소나: Role Prompting (3) ------------------------------------------------------
당신은 나의 주장에 대해 반대 주장을 펼쳐야 합니다. 내가 어떤 이야기나 주장을 하든, 의심스러운 시각에서 항상 반대되는 의견을 세부적으로 제시해주세요.

외환 위기로 우리 회사는 매우 힘든 한 해를 보낼 것 같습니다.

--- 답변 길이 지정 (1) ------------------------------------------------------------------
학생 회장 선거 연설문을 트윗 길이로 작성하세요.

--- 답변 길이 지정 (2) ------------------------------------------------------------------
학생 회장 선거 연설문을 약 100단어로 작성하세요.

--- 답변 길이 지정 (3) ------------------------------------------------------------------
학생 회장 선거 연설문을 세 문단으로 작성하세요.

--- 구조화한 출력 형식 요청 (1) ------------------------------------------------------------------
세 개의 가상 책 제목과 그에 해당하는 저자 및 장르를 생성하세요.

--- 구조화한 출력 형식 요청 (2) ------------------------------------------------------------------
세 개의 가상 책 제목과 그에 해당하는 저자 및 장르를 HTML 형식으로 생성하세요.

--- 구조화한 출력 형식 요청 (3) ------------------------------------------------------------------
세 개의 가상 책 제목과 그에 해당하는 저자 및 장르를 JSON 형식으로 생성하세요.

--- 추상적이고 일반적인 지침 vs. 명확하고 구체적인 지침 (1) --------------------------------------------
좋은 책 추천해주세요.

--- 추상적이고 일반적인 지침 vs. 명확하고 구체적인 지침 (2) --------------------------------------------
최근 5년 내에 출판된 과학 기술 분야의 비소설 책 중에서 평점이 4.5 이상인 책을 추천해주세요.

--- 추상적이고 일반적인 지침 vs. 명확하고 구체적인 지침 (3) --------------------------------------------
2020년부터 2024년 사이에 출판된 인공지능 분야의 비소설 책 중에서 평점이 4.5 이상인 책을 5권 추천해주세요.

--- 더 명확하고 구체적인 지침 ------------------------------------------------------------
2020년부터 2024년 사이에 출판된 인공지능 분야의 비소설 책 중에서 평점이 4.5 이상인 책을 5권 추천해주세요.
--------------------------------------
제목: <책 제목>
저자: <책 저자>
내용: <책 내용 요약>
연도: <출간 연도>
평점: <평점>

--- 외국어(영어) 문장 수정 -------------------------------------------------------------
사용자의 요청에 다음 사항을 기반해서 답하세요.

# 지시문
당신은 나의 영어 과외 선생님이며, 영어 원어민입니다. 제가 입력한 영어 문장을 자연스러운 영어로 교정해 주고, 그렇게 교정한 이유를 설명해 주세요. 또한, 제 질문에 대한 답을 주세요.

# 당신의 정보
- 당신은 나의 영어 선생님입니다.
- 당신은 미국 출신의 원어민으로, 매우 일반적인 영어를 사용합니다.
- 당신은 또한 한국어를 열심히 배워서 원어민 수준의 한국어도 구사합니다. 하지만 여전히 모국어는 영어입니다.

# 출력 형식
수정 : [제가 입력한 영어 문장을 자연스러운 영어로 바꿔서 출력]
이유 : [그렇게 수정한 이유를 한국어로 출력]
대체 표현 : [제가 입력한 문장과 비슷한 표현을 추천]
답변 : [제가 입력한 문장에 대한 당신의 답을 영어로 출력]
해석 : [당신의 답변에 대한 한국어 해석을 출력]

--- 템플릿 사용 (A-1) --------------------------------------------------------------
출력물을 위한 템플릿을 제공해 드리겠습니다. 꺾쇠 괄호 <> 안의 단어가 플레이스홀더입니다. 플레이스홀더를 채워주세요. 제 템플릿의 전체 서식을 그대로 유지해 주세요. 제 템플릿은 다음과 같습니다.

출발 공항: <출발 공항 이름>
공항 코드: <출발 공항 코드>

도착 공항: <도착 공항 이름>
공항 코드: <출발 공항 코드>

인천에서 파리까지 비행기를 타고 가고 싶어요.

--- 템플릿 사용 (A-2) --------------------------------------------------------------
제주에서 뉴욕까지 가고 싶어요.

--- 템플릿 사용 (A-3) --------------------------------------------------------------
런던에서 시드니까지 여행 가고 싶어요.

--- 템플릿 사용 (B) --------------------------------------------------------------
결과물을 위한 템플릿을 제공해 드리겠습니다. 꺾쇠 괄호 <> 안의 단어가 플레이스홀더입니다. 
플레이스홀더를 당신의 결과물로 채워주세요. 제 템플릿의 전체 서식을 그대로 유지해 주세요. 제 템플릿은 다음과 같습니다:

질문: <질문>
대답: <답변>

템플릿을 채울 데이터를 제공받으면 템플릿의 서식에 맞게 대답하세요.

아래 URL에 있는 내용을 사용하여 20개의 질문을 만드세요.
https://en.wikipedia.org/wiki/Korean_language

--- 프롬프트에 변수 사용 ---------------------------------------------------------------
# 변수
{city} = 서귀포

# 프롬프트
당신은 여행 가이드입니다. 도시 {city}에 대한 정보를 하나 알려주세요.

--- 더 나은 질문 만들기 ---------------------------------------------------------------
지금부터 내가 질문을 할 때, 더 나은 질문 방식이 있다면 제안하고, 그 질문을 사용할지 여부를 나에게 물어봐 주세요.

--- 더 나은 질문 만들기 (1) ---------------------------------------------------------------
전 세계에는 몇 개의 국가가 있나요?

--- 더 나은 질문 만들기 (2) ---------------------------------------------------------------
지구의 온난화는 심각한가요?

--- 더 나은 질문 만들기 (3) ---------------------------------------------------------------
업무 효율성을 어떻게 높일 수 있을까요?

--- 대안 프롬프트 요청하기 --------------------------------------------------------------
제가 작업을 수행하기 위한 프롬프트를 작성해 달라고 요청할 때마다 작업이 무엇인지 나열하고, 작업을 완료하기 위한 대체 접근 방법을 나열한 다음, 각 접근 방식에 대한 프롬프트를 직접 작성하세요. 완료되면 대안을 작성할 다음 프롬프트를 만들 수 있는지 물어보세요.

--- 대안 프롬프트 요청하기 (1) --------------------------------------------------------------
언어 모델이 일련의 이메일에서 질문을 자동으로 감지하도록 프롬프트를 작성하고 각 질문 아래에 글머리 기호로 질문에 대한 모든 사람의 의견을 요약합니다.

--- 대안 프롬프트 요청하기 (2) --------------------------------------------------------------
이메일 대화에서 질문을 요약하는 여러 가지 프롬프트와 질문에 대한 다양한 이해 관계자의 관점을 평가하는 프롬프트를 작성합니다.

--- 질문 받기 (1) ----------------------------------------------------------------------
나는 수학 공부를 잘 하고 싶어요. 이 목표를 달성하기 위해 나에게 질문을 해 주세요. 충분한 정보를 얻어 나에게 적합한 수학 공부 계획을 제안할 수 있을 때까지 질문을 계속하세요. 정보를 다 모으면 수학 공부 계획을 보여 주세요. 질문을 한 번에 하나씩 하세요. 

첫 번째 질문을 시작해 주세요.

--- 질문 받기 (2) ----------------------------------------------------------------------
나의 운동 목표에 대해 질문을 해 주세요. 충분한 정보를 얻어 나에게 적합한 근력 운동 계획을 제안할 수 있을 때까지 질문을 계속하세요. 정보를 다 모으면 근력 운동 계획을 보여 주세요. 질문을 한 번에 하나씩 하세요. 

첫 번째 질문을 시작해 주세요.

--- 수학 게임 ---------------------------------------------------------------------
수학 게임을 하겠습니다. 분수와 관련된 질문을 하고 맞출 때마다 점수를 증가시키세요. 답이 틀리면 이유를 알기 쉽게 설명하세요. 

--- AI를 프로그래밍 할 수 있을까? (1) --------------------------------------------------------
아래 내용을 CSV 형식으로 출력하세요.

최근 발견된 행성 후르츠에서는 많은 과일들이 있습니다. 거기에서 자라는 네오스키즐이라는 과일은 보라색이며 사탕처럼 달콤한 맛이 납니다. 또한 회색빛 파란색의 과일인 로헤클도 있으며, 레몬처럼 매우 시큼합니다. 파운잇은 밝은 녹색이며 단맛보다는 짭짤한 맛이 납니다. 네온 핑크색의 루프노바도 풍부하며, 솜사탕처럼 맛이 납니다. 마지막으로, 옅은 오렌지색을 띠는 글로울이라는 과일은 신맛과 쓴맛이 매우 강하며 산성이고 부식성이 있습니다.

--- AI를 프로그래밍 할 수 있을까? (2) --------------------------------------------------------
아래 내용을 CSV 형식으로 출력하세요.
제 이름은 홍길동입니다. 저는 현재 프롬프트 엔지니어링 수업을 듣고 있습니다.

--- AI를 프로그래밍 할 수 있을까? (3) --------------------------------------------------------
아래 내용을 CSV 형식으로 출력하세요. 컬럼을 이름, 역할, 수업으로 합니다.
제 이름은 홍길동입니다. 저는 현재 프롬프트 엔지니어링 수업을 듣고 있습니다.

--- AI를 프로그래밍 할 수 있을까? (4) --------------------------------------------------------
내가 입력하는 내용 외에도, 내가 요청한 CSV 형식에 맞는 추가 예시를 생성하세요.
제 이름은 홍길동입니다. 저는 현재 인공지능 특강을 듣고 있습니다.

--- 여행 계획 (A) --------------------------------------------------------------
여행 계획 애플리케이션을 만들려고 합니다. 저는 제 여행에 관해 설명하고 당신은 제가 지나갈 장소에서 할 수 있는 흥미로운 일을 나열합니다. 각 장소에서 며칠 동안 머무를 것인지 알려드리고 가능한 여정을 나열하겠습니다.
제 경로를 설명하기 위해 속기 표기법를 사용하겠습니다.
'뉴욕,3->파리,2'는 뉴욕에서 파리로 이동하고 뉴욕에서 3일, 파리에서 2일을 머문다는 뜻입니다.

--- 여행 계획 (A-1) --------------------------------------------------------------
서울,0->오사카,2->교토,1

--- 여행 계획 (A-2) --------------------------------------------------------------
런던,2->파리,4->로마,5->마드리드,3

--- 여행 계획 (B) --------------------------------------------------------------
기능을 추가하려고 합니다. 출발지와 도착지를 알려주면 출발지와 도착지 사이에 경유할 장소를 포함한 전체 경유지 목록을 제공합니다.

--- 여행 계획 (B-1) --------------------------------------------------------------
뉴욕,0->…->…->시카고,3

--- 여행 계획 (B-2) --------------------------------------------------------------
런던,1->…->프라하,2

--- 개요 확장하기 -------------------------------------------------------------------
개요 확장자 역할을 하세요. 제가 입력한 내용을 바탕으로 글머리 번호 개요를 생성한 다음, 어떤 글머리 번호를 확장할지 물어봅니다. 제가 선택한 글머리 번호에 대한 새로운 개요를 만듭니다. 마지막에는 다음에 확장할 글머리 기호를 물어보세요.

지구 온난화의 위험성

--- 액션 메뉴 만들기 -----------------------------------------------------------------
내가 입력한 내용을 바탕으로 글머리 번호 개요를 생성한 다음, 어떤 글머리 번호를 확장할지 물어봅니다. 내가 선택한 글머리 번호에 대한 새로운 개요를 만듭니다. 내가 "<글머리 번호> 글쓰기"라고 입력하면, 선택한 글머리 번호 <글머리 번호>에 대한 내용을 작성합니다. 최소한 3단락 이상의 내용을 작성합니다. 내가 "<글머리 번호>"만 입력하면, 해당 글머리 기호를 확장합니다. 마지막에는 다음 작업을 물어보세요.

지구 온난화의 위험성

--- 사실 확인 ---------------------------------------------------------------------
내가 입력한 내용을 바탕으로 글머리 번호 개요를 생성한 다음, 어떤 글머리 번호를 확장할지 물어봅니다. 내가 선택한 글머리 번호에 대한 새로운 개요를 만듭니다. 내가 "<글머리 번호> 글쓰기"라고 입력하면, 선택한 글머리 번호 <글머리 번호>에 대한 내용을 작성합니다. 최소한 3단락 이상의 내용을 작성합니다. 내가 "<글머리 번호>"만 입력하면, 해당 글머리 기호를 확장합니다. 텍스트를 출력할 때마다 결과물에 포함할 사실 세트를 생성합니다. 사실 세트는 결과물의 끝에 삽입해야 합니다. 사실 세트는 사실 중 하나라도 틀릴 경우 결과물의 진실성을 약화시킬 수 있는 근본적인 사실이어야 합니다. 마지막에는 다음 작업을 물어보세요.

지구 온난화의 위험성

--- 역 프롬프트 --------------------------------------------------------------------
https://singjupost.com/steve-jobs-how-to-live-before-you-die-2005-speech-full-transcript/
이 글을 읽고 이러한 글을 만들 수 있는 프롬프트를 작성해주세요.

--- 대안 접근 방식 요청하기 ----------------------------------------------------------
지금부터 같은 작업을 수행할 수 있는 다른 방법이 있다면 가장 좋은 대안을 나열하세요. 대안을 비교하고 대조한 다음 어떤 방법을 사용할지 물어보세요.

데이터에 결측치(missing value)가 있어서 분석이나 모델링 전에 처리해야 해요.

--- 시멘틱 필터링 -------------------------------------------------------------------
다음 내용을 필터링하여 개인 식별이 가능한 정보 또는 개인을 재식별하는 데 사용될 수 있는 정보를 제거합니다. 정보를 제거한 후 최소한의 수정으로 내용을 자연스럽게 만듭니다.

강감찬은 서울특별시 강남구 테헤란로에 위치한 한 회사에서 근무하고 있으며, 연락처는 010-1234-5678이다. 회사 내에서 중요한 역할을 맡고 있어 업무상 다양한 프로젝트를 이끌고 있다. 이순신은 부산광역시 해운대구에 거주하며, 현재 창업을 준비하고 있다. 그와 연락하려면 010-9876-5432로 연락할 수 있다. 또한, 유관순은 대전광역시 서구 둔산동에서 중소기업을 운영하고 있으며, 개인 이메일 주소로는 yoo.gwansoon@example.com이 사용된다. 이 세 사람은 최근 진행된 공동 프로젝트에서 협업하며 각자의 전문성을 발휘하여 성공적으로 업무를 마무리했다.

--- 스텝백 프롬프트: Step-back Prompting (1) -------------------------------------------------------------------
이 글의 톤과 스타일을 다시 검토하세요. 대화체와 따뜻한 톤으로 작성되었는지 확인하고, 보다 격려하고 공감하는 느낌을 줄 수 있도록 수정하세요.

--- 스텝백 프롬프트: Step-back Prompting (2) -------------------------------------------------------------------
이 글을 간결하게 다시 작성하세요. 주요 메시지가 더 명확하게 전달되도록 구조를 재정비하고, 각 문단이 논리적으로 연결되도록 하세요.

--- 스텝백 프롬프트: Step-back Prompting (3) -------------------------------------------------------------------
이 글에서 가장 중요한 메시지가 무엇인지 파악하고, 이를 더 두드러지게 강조하도록 수정하세요. 불필요한 세부 사항은 제거하고, 읽는 사람이 즉각적으로 메시지를 이해할 수 있도록 표현하세요.

--- 스텝백 프롬프트: Step-back Prompting (4) -------------------------------------------------------------------
이 글의 결론 부분을 설득력 있게 다시 작성하세요. 독자가 글의 메시지를 실천하도록 동기부여할 수 있는 강렬한 마무리로 바꾸세요.

--- 스텝백 프롬프트: Step-back Prompting (5) -------------------------------------------------------------------
이 글을 대상 독자인 대학생이 더 공감하고 이해할 수 있도록 수정하세요. 구체적인 예시나 사례를 추가하여 더 친근하게 느껴지도록 하세요.

--- 스텝백 프롬프트: Step-back Prompting (6) -------------------------------------------------------------------
이 텍스트의 문법과 문장 구조를 점검하고 수정하세요. 문장이 자연스럽게 연결되도록 하며, 읽기 쉽게 다듬으세요.

--- CoT 프롬프트 사용하지 않음 -----------------------------------------------
내가 5살이었을 때, 내 사촌은 내 나이의 3배였습니다. 지금 나는 19살입니다. 내 사촌은 몇 살인가요? Return the answer directly.

--- CoT 프롬프트 사용 -----------------------------------------------
내가 5살이었을 때, 내 사촌은 내 나이의 3배였습니다. 지금 나는 19살입니다. 내 사촌은 몇 살인가요? Let's think step by step.

--- 사고의 나무: Tree of Thoughts (ToT) 1 단계 ---------------
{인간의 화성 이주}와 관련된 문제가 있습니다. 세 가지 해결책을 브레인스토밍해 주세요.
{지구와 화성 사이의 거리가 매우 멀기 때문에 정기적인 재보급이 어렵다}와 같은 다양한 요소를 고려해 주세요.
대답:

--- 사고의 나무: Tree of Thoughts (ToT) 2 단계 ---------------
제안한 세 가지 솔루션 각각에 대해 그 잠재력을 평가합니다. 장단점, 필요한 초기 노력, 구현 난이도, 잠재적인 문제, 예상되는 결과를 고려합니다. 이러한 요소들에 따라 각 옵션에 대한 성공 확률과 신뢰 수준을 계산합니다.
{solutions}
대답:

--- 사고의 나무: Tree of Thoughts (ToT) 3 단계 ---------------
각 솔루션에 대해 사고 과정을 심화합니다. 잠재적인 시나리오, 실행 전 략, 필요한 파트너십이나 리소스, 잠재적인 장애물을 극복할 수 있는 방 법을 생성하세요. 또한 예상치 못한 결과가 발생할 수 있는 경우와 그 처리 방법도 고려하세요
{review}
대답: 

--- 사고의 나무: Tree of Thoughts (ToT) 4 단계 ---------------
평가와 시나리오를 바탕으로 실현 가능성이 높은 순서대로 솔루션의 순위를 매깁니다. 각 순위에 대한 근거를 제시하고 각 솔루션에 대한 최종 생각이나 고려 사항을 제안합니다.
{deepen_thought_process} 
대답: 

--- 코드 프롬프트: 코드 설명 ------------------------------------------------------------
아래 파이썬 코드를 설명해주세요.
```
leaps = [year for year in range(2000, 3001)
 if year % 4 == 0 and year % 100 != 0 or year % 400 == 0]
print(leaps)
```

--- 코드 프롬프트: 코드 버그 수정 ------------------------------------------------------------
아래 파이썬 코드에서 버그를 찾아 수정하세요. 어디가 틀렸는지를 각각 한국어로 설명하고 수정한 코드를 최종 보여주세요.
```
import Random
a = random.randint(1,12)
b = random.randint(1,12)
for i in range(10):
 question = 'What is ' + a + ' x ' + b + '? '
 answer = input(question)
 if answer = a*b
 print (Well done!)
 else:
 print('No.')
```

--- 코드 프롬프트: 코드 효율성 향상 ------------------------------------------------------------
아래 파이썬 코드의 효율성을 개선할 아이디어를 주세요. 한국어로 설명하고 수정한 코드를 보여주세요.
```
from typing import List

def has_sum_k(nums: List[int], k: int) -> bool:
 n = len(nums)
 for i in range(n):
 for j in range(i+1, n):
 if nums[i] + nums[j] == k:
 return True
 return False
```

--- 코드 프롬프트: 코드 작성 ------------------------------------------------------------
아래 내용을 파이썬 코드로 작성한다.

<내용>
주어진 판매 데이터를 기반으로 월별 매출 추세를 분석하고, 향후 6개월간의 매출을 예측하는 파이썬 코드를 작성하시오. 이를 위해 다음을 수행합니다.
1. CSV 파일에서 데이터를 불러오고, 월별로 집계된 매출 데이터를 생성합니다.
2. Pandas 및 Matplotlib 라이브러리를 사용해 월별 매출 추세를 시각화합니다.
3. ARIMA 또는 Prophet 모델을 사용해 향후 6개월간 매출을 예측하는 코드를 작성합니다.
4. 각 단계에 대한 설명과 함께 결과물을 시각화하여 출력합니다.
</내용>

--- 코드 프롬프트: 다른 프로그래밍 언어로 변환 ------------------------------------------------------------
아래 파이썬 코드를 JavaScript 코드로 바꿔주세요.
```
leaps = [year for year in range(2000, 3001)
 if year % 4 == 0 and year % 100 != 0 or year % 400 == 0]
print(leaps)
``` 

--- 자동 프롬프트 엔지니어링 ------------------------------------------------------------
온라인 주문 시스템이 있는 커피숍을 운영하고 있으며 챗봇을 훈련시키고 있습니다. '아메리카노 라지 한 잔 주세요'라는 요청을 다양한 방식으로 표현할 수 있는 방법이 필요합니다. 같은 의미를 전달하지만 다른 문구를 사용하는 10가지 변형을 생성해주세요.

--- Reason and Act (ReAct) ----------------------------------------------------
질의 응답 작업을 수행하기 위해 다음과 같이 '생각(Thought)', '실행(Action)', '관찰(Observation)' 단계를 번갈아 순차적으로 행합니다.

- [생각] 단계에서는 현재 상황을 논리적으로 추론합니다.
- [관찰] 단계에서는 해당 [실행]을 통해 얻은 정보를 이해하고 정리합니다.
- [실행] 단계는 다음 세 가지 유형 중 하나가 될 수 있습니다.
1) <search>대상</search>
   + '대상'을 검색하여, 존재하면 첫 번째 단락(또는 요약)을 정보를 반환합니다.
   + 만약 검색 결과가 없다면, 유사어를 추천해 줄 수 있고, 필요에 따라 다른 관련 검색어나 유사한 항목을 추가로 검색하여 정보를 찾을 수 있습니다.
2) <lookup>키워드</lookup>
   + 현재까지 확보한 텍스트(맥락) 안에서 '키워드'가 들어간 다음 문장을 반환합니다.
   + 이는 정확히 일치(Exact Match)하는 키워드 검색만 수행하므로, 검색어를 짧게 유지하세요.
3) <finish>답변</finish>
   - 최종적으로 질문에 대한 답변을 제시하며, 작업을 종료합니다.

<예제 1>
질문: 조선 시대에 창건된 경복궁(景福宮)의 명칭은 어떤 유교 경전에서 유래된 것인가?

[생각] - 경복궁의 이름이 어떤 경전에서 나왔는지 확인하기 위해 '경복궁'을 검색한다.
[실행] - <search>경복궁</search>
[관찰] - 경복궁은 1395년에 창건되었으며, '크나큰 복을 누린다'라는 의미를 지닌다.

[생각] - 어느 유교 경전에서 이 이름을 따왔는지 추가로 조사해야겠다.
[실행] - <lookup>이름 유래</lookup>
[관찰] - 경복궁(景福宮)이라는 명칭은 유교 경전인 '주역(周易)'의 한 구절에서 유래되었다.

[생각] - 최종 답은 '주역'
[실행] - <finish>주역</finish>
</예제 1>

<예제 2>
질문: 직지심체요절(Jikji)은 금속활자로 인쇄된 가장 오래된 책 가운데 하나로 알려져 있는데, 현재 남아 있는 권(卷)은 몇 권이며, 어디에 보관되어 있는가?

[생각] - 우선 '직지심체요절'에 대해 검색해서, 원래 몇 권으로 구성되었는지, 그리고 현존하는 권이 몇 권이며 어디에 보관 중인지 확인해야 한다.
[실행] - <search>직지심체요절</search>
[관찰] - 직지심체요절(直指心體要節)은 고려 시대인 1377년에 청주 흥덕사에서 금속활자로 인쇄된 불교 서적이다. 상·하 2권으로 이루어져 있지만, 현재 남아 있는 것은 하권 한 권뿐이다. 이 하권은 프랑스 국립도서관(BnF)에 소장되어 있으며, 2001년 유네스코 세계기록유산(UNESCO Memory of the World)으로 등재되었다.

[생각] - 원래 2권(상권, 하권)인데, 지금은 하권만 남아 있고, 프랑스 국립도서관에 보관되어 있다는 내용이 확인되었다.
[실행] - <lookup>권(卷)</lookup>
[관찰] - 상·하 총 2권 중 하권만 현존한다는 내용이 재확인된다. 상권은 현재 전해지지 않는 것으로 알려져 있다.

[생각] - 추가로 어디에 소장되는지 확인해야 한다. 이미 '프랑스 국립도서관(BnF)'이라고 나왔으니 좀 더 자세한 정보를 확인해보자.
[실행] - <lookup>소장</lookup>
[관찰] - 직지심체요절 하권은 1887년 프랑스 외교관에 의해 해외로 반출된 뒤, 현재 파리의 프랑스 국립도서관에 소장되어 있다.

[생각] - 정리하면, 직지심체요절은 원래 상·하 2권이며, 지금은 하권만 남아 있고 프랑스 국립도서관(BnF)에 보관 중이다. 이것이 최종 답변이다.
[실행] - <finish>직지심체요절은 2권 중 하권만 현존하며, 프랑스 국립도서관에 소장되어 있습니다.</finish>
</예제 2>

질문: 영화 '기생충'(2019)의 공식 포스터 혹은 배급사 보도자료 기준, 주연 배우(카메오·아역배우 제외) 중에서 촬영 당시 가장 나이가 어렸던 배우는 누구입니까?

--- 자가 개선 프롬프트 (1) ------------------------------------------------------------------
우리 함께 로봇을 만들 수 있나요?

--- 자가 개선 프롬프트 (2) ------------------------------------------------------------------
농구 게임을 하는 로봇을 만들고 싶어요. 재료는 아직 잘 몰라서 구하지 못했습니다. 로봇 만든 경험은 없습니다. 예산은 필요한 경우 구해볼게요.

--- 자가 개선 프롬프트 (3) ------------------------------------------------------------------
바퀴로 로봇은 이동을 합니다. 흡착하는 방식으로 농구공을 잡고 팔을 이용해 공을 던져 슛이나 패스를 합니다. 다른 로봇과 협업하여 게임을 진행하며 공을 자동으로 인지하고 찾아가야 합니다.

--- 제약보다 지시 ------------------------------------------------------------------
상위 5개의 스마트폰에 대한 블로그 글을 한 단락으로 작성해 주세요. 브랜드, 출시 연도, 주요 기술적 특징, 그리고 총 판매량을 중심으로 다뤄 주시면 됩니다.

<<텍스트 프롬프트: 챗봇>>
--- 영어 회화 챗봇 ------------------------------------------------------------------
당신은 영어 회화 파트너입니다. 사용자가 대화 연습을 원하는 주제나 상황을 알려주면, 그에 맞는 영어 대화를 시작해주세요. 영어로 말한 뒤 영어의 뜻을 괄호 안에 적어주세요. 만일 사용자의 영어가 부적절하거나 더 나은 표현이 있다면 어떻게 영어로 표현하는지 가르쳐주세요. 그리고 사용자가 영어로 대답을 못하고 한국어로 대답하면 그 대답을 어떻게 영어로 할 수 있는지 알려주세요. 당신의 모든 설명은 한국어로 하세요.

--- 영어 단어 공부 챗봇 ---------------------------------------------------------------
당신은 영어 단어를 재미있고 효과적으로 배울 수 있도록 도와주는 친근하고 격려하는 영어 선생님입니다.

# 지침
1. 먼저 사용자 정보를 파악합니다.
- **나이**: 연령에 따라 이야기의 난이도와 주제를 조정합니다.
- **어휘 수준**: 초급, 중급, 고급에 따라 사용하는 단어의 난이도를 맞춥니다.
- **관심사**: 동물, 모험, 판타지, 스포츠 등 사용자가 좋아하는 주제를 반영합니다.

2. 사용자의 수준에 맞는 영어 단어 하나를 선택한 후 사용자에게 해당 영어 단어의 뜻을 물어봅니다.
- 사용자의 답이 틀리면 해당 단어의 **뜻**과 **발음**을 간단히 설명합니다.
- 사용자의 정답이 맞다면 칭찬을 하고 해당 단어의 **뜻**과 **발음**을 간단히 설명합니다.

3. 해당 단어의 뜻을 설명한 후, 이 단어와 관련이 있는 문장과 재미있는 짧은 이야기를 알려줍니다.
- 해당 단어를 포함한 문장 3개를 만들어 보여주고, 그 뜻을 설명합니다.
- 3. 해당 단어의 뜻을 설명한 후, 이 단어와 관련이 있는 문장과 재미있는 짧은 이야기를 알려줍니다.
- 해당 단어를 포함한 문장 3개를 만들어 보여주고, 그 뜻을 설명합니다.
- 그 다음, 해당 단어와 관련된 재미 있는 이야기를 {영어} 3-5 문장으로 만들어 보여주고 한국어로 해석을 합니다.

4. 마지막 단계로 해당 단어가 어떤 상황에서 사용할 수 있는지 퀴즈를 통해 사용자에게 물어봅니다.
- 사용자의 대답에 따라 적절하게 대답하세요.

5. (2), (3), (4) 단계를 마치면 새로운 단어를 공부할지 물어봅니다.

당신의 모든 설명은 한국어로 하세요.

--- 한식당 챗봇 --------------------------------------------------------------------
당신은 한식당을 위한 자동 주문봇입니다. 먼저 고객에게 인사를 한 뒤 메뉴를 보여줍니다. 음식 메뉴는 다음과 같습니다.
[메인 메뉴]
- 불고기 15,000원
- 비빔밥 10,000원
- 김치찌개 8,000원
- 해물파전 12,000원
- 잡채 9,000원
[추가 옵션]
- 계란 1,000원
- 두부 1,500원
- 고기 3,000원
- 해산물 4,000원
- 고추장 500원
- 김치 1,000원
[음료]
- 콜라 / 사이다  2,000원
고객으로부터 주문을 받으면 먼저 주문한 음식이 메뉴에 있는지 확인합니다.  메뉴에 있는 음식이면, 주문 내역을 고객에게 요약하고, 고객이 추가로 주문할 것이 있는지 최종 확인합니다. 메뉴에서 항목을 구별할 수 있도록 모든 옵션 및 추가 사항 등을 명확히 해야 합니다. 
최종 확인 시, 고객이 주문한 메뉴와 해당 메뉴의 가격을 다시 확인하여  오류가 없는지 검토하세요. 메뉴 가격이나 최종 합계 계산이 틀렸다면 수정 후 총 합계를 고객에게 알려줍니다.
최종 주문을 확인 한 후 고객에게 픽업인지 배달인지 묻습니다. 배달인 경우 주소를 묻습니다. 마지막으로 결제를 진행합니다. 결제 방식으로는 현금 결제, 신용카드 결제, 모바일 결제가 있습니다. 이 중 고객이 원하는 결제 방식으로 결제를 처리합니다. 대화식이고 친근한 스타일로 간단하게 대답합니다.

<<이미지 프롬프트>>
--- 이미지 인식 (1) --------------------------------------------------------------------
이미지를 보이는 대로 설명하세요.

--- 이미지 인식 (2) --------------------------------------------------------------------
이 식물은 어떤 종류인가요? 한 단락으로 설명하세요.

--- 이미지 인식 (3) --------------------------------------------------------------------
이 개 품종은 무엇인가요? 한 단락에 글머리 기호로 설명하세요.

--- 이미지 인식 (4) --------------------------------------------------------------------
이 개 품종은 무엇인가요? 한 단락에 글머리 기호로 설명하세요.

--- 이 이미지에 어떤 문제가 있나요? ----------------------------------------------------
이게 무슨 문제인가요? 좋은 숫자는 무엇이어야 하나요?

--- 영수증 분석 (A) --------------------------------------------------------------------
영수증에 표시된 총 청구 금액은 얼마인가요?

--- 영수증 분석 (B) --------------------------------------------------------------------
모든 영수증의 총 청구 금액은 얼마인가요?

--- 영수증 분석 (C-1) --------------------------------------------------------------------
생선회는 총 몇 개 구입했나요?

--- 영수증 분석 (C-2) --------------------------------------------------------------------
생선회 총 청구 금액은 얼마인가요?

--- 영수증 분석 (C-3) --------------------------------------------------------------------
구입한 쇠고기의 총 금액은 얼마인가요?

--- 영수증 분석 (C-4) --------------------------------------------------------------------
어떤 야채를 구입했나요? 금액은 얼마인가요?

--- 영수증 분석 (C-5) --------------------------------------------------------------------
세금은 총 얼마인가요?

--- 영양 분석 (1) ---------------------------------------------------------------------
다이어트 중이에요. 어떤 음료를 마셔야 할까요?

--- 영양 분석 (2) ---------------------------------------------------------------------
쉽게 비교할 수 있도록 두 음료의 영양 성분을 JSON 형식으로 만드세요.

--- 다이어그램 분석 및 코드 생성 ----------------------------------------------------------
이 다이어그램의 흐름을 텍스트로 요약한 다음, 흐름을 구현하는 파이썬 프로그램을 작성하세요.

--- 데이터 변환 (1) ----------------------------------------------------------------------
차트를 Markdown 테이블로 변환합니다.

--- 데이터 변환 (2) ----------------------------------------------------------------------
차트를 HTML 테이블로 변환합니다.

--- 냉장고 음식으로 요리하기 (1) -------------------------------------------------------------
냉장고에는 무엇이 있나요? 어떤 종류의 음식을 만들 수 있나요? 냉장고에 있는 재료만을 기준으로 두 가지 예를 보여주세요.

--- 냉장고 음식으로 요리하기 (2) -------------------------------------------------------------
냉장고에 바나나가 있나요? 어디에 있나요?

--- 수학 문제 채점 ------------------------------------------------------------------
학생의 수학 숙제에서 각 답을 주의 깊게 확인하고, 먼저 계산을 한 다음, 결과를 학생의 답과 비교하고, 각 답에 정답 또는 오답을 표시한 다음, 마지막으로 모든 문제에 대한 총점을 반환하세요.

<<동영상 프롬프트>>
--- 동영상 이해 --------------------------------------------------------------------
이 동영상이 어떤 내용인지 설명해 주세요.

    """
    
    # 카테고리와 프롬프트 제목, 내용을 분리
    categories = defaultdict(list)
    current_category = None
    
    lines = data.strip().split('\n')
    i = 0
    while i < len(lines):
        line = lines[i]
        # 카테고리 추출
        category_match = re.match(r'<<(.+)>>', line)
        if category_match:
            current_category = category_match.group(1).strip()
            i += 1
            continue
        
        # 프롬프트 제목 추출 (패턴: --- 뒤에 제목과 구분선)
        title_match = re.match(r'--- (.+?) -+', line)
        if title_match and current_category:
            title = title_match.group(1).strip()
            content_lines = [line]  # 제목 라인 포함
            j = i + 1
            # 다음 프롬프트 제목 또는 카테고리 라인까지 내용 수집
            while j < len(lines):
                next_line = lines[j]
                if re.match(r'--- .+? -+', next_line) or re.match(r'<<.+>>', next_line):
                    break
                content_lines.append(next_line)
                j += 1
            content = '\n'.join(content_lines)
            categories[current_category].append({
                'title': title,
                'content': content
            })
            i = j
        else:
            i += 1
    
    return categories

# 비밀번호 확인
def check_password():
    """
    사용자가 입력한 비밀번호를 확인합니다.
    정확한 비밀번호가 입력되면 True를 반환합니다.
    """
    if 'password_verified' not in st.session_state:
        st.session_state.password_verified = False
    
    if st.session_state.password_verified:
        return True
    
    # 웹사이트 제목과 설명 추가
    st.title("실습 프롬프트")
    st.markdown("프롬프트 엔지니어링 학습을 위한 실습 프롬프트")
    
    password_input = st.text_input(
        "비밀번호를 입력하세요:", 
        type="password",
        help="프롬프트 모음을 보기 위한 비밀번호를 입력하세요."
    )
    
    if password_input == PASSWORD:
        st.session_state.password_verified = True
        return True
    elif password_input:
        st.error("비밀번호가 일치하지 않습니다.")
    
    return False

# 프롬프트 표시
def display_prompts():
    """
    카테고리와 프롬프트를 표시합니다.
    """
    # 데이터 준비
    categories = prepare_data()
    
    # 사이드바 설정
    st.sidebar.title("목차")
    
    # 카테고리별 메뉴
    for category, prompts in categories.items():
        st.sidebar.subheader(category)
        for prompt in prompts:
            title = prompt['title']
            # 링크의 앵커를 고유하게 만들기 위해 카테고리도 포함
            anchor = f"{category.replace(' ', '-')}-{title.replace(' ', '-')}"
            st.sidebar.markdown(f"- [{title}](#{anchor})")
    
    # 메인 콘텐츠
    st.title("실습 프롬프트")
    st.markdown("---")
    
    # 카테고리별 프롬프트 표시
    for category, prompts in categories.items():
        st.header(category)
        for prompt in prompts:
            title = prompt['title']
            content = prompt['content']
            
            # 고유한 앵커 생성
            anchor = f"{category.replace(' ', '-')}-{title.replace(' ', '-')}"
            
            # 제목 라인을 제외한 나머지 내용 추출
            content_lines = content.split('\n')
            actual_content = '\n'.join(content_lines[1:]).strip()
            
            # 앵커 포인트 추가
            st.markdown(f"<a name='{anchor}'></a>", unsafe_allow_html=True)
            st.subheader(title)

            # 코드 블럭이 있는 경우에만 따로 처리
            if "```" in actual_content:
                code_block_pattern = r"```(.*?)```"  # non-greedy
                matches = re.split(code_block_pattern, actual_content, flags=re.DOTALL)

                for i, chunk in enumerate(matches):
                    if i % 2 == 0:
                        if chunk.strip():
                            st.markdown(chunk.strip())
                    else:
                        st.code(chunk.strip(), language='python')
            else:
                # 코드 블럭이 없으면 그냥 통째로 마크다운 처리
                st.markdown(actual_content)

            st.markdown("---")

# 메인 애플리케이션
def main():
    """
    애플리케이션의 메인 기능입니다.
    """
    if check_password():
        display_prompts()

if __name__ == "__main__":
    main()
